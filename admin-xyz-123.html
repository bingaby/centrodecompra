<!DOCTYPE html><html lang="pt-br"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Gerenciar Produtos</title><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"><style>body{font-family:'Roboto',Arial,sans-serif;padding:20px;background-color:#f5f5f5}h1,h3{text-align:center;color:#333}form{max-width:500px;margin:auto;display:flex;flex-direction:column;gap:10px;background:white;padding:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}input,select,button,textarea{padding:10px;border:1px solid #ddd;border-radius:4px;font-size:16px}button{background-color:#ff6200;color:white;border:none;cursor:pointer;font-weight:bold}button:hover{background-color:#e55a00}#mensagem{margin-top:10px;color:green;text-align:center}#erro{margin-top:10px;color:red;text-align:center}#github-sync{margin-top:20px;max-width:500px;margin:auto;background:white;padding:10px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}#github-sync textarea{width:100%;height:100px;resize:vertical}#github-sync input{margin-bottom:10px}#github-sync button{margin-top:10px;width:100%}#produtos-cadastrados{margin:20px auto;max-width:800px;background:white;padding:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}#produtos-cadastrados table{width:100%;border-collapse:collapse}#produtos-cadastrados th,#produtos-cadastrados td{padding:10px;border:1px solid #ddd;text-align:left}#produtos-cadastrados th{background-color:#f9f9f9}#produtos-cadastrados button.excluir{background-color:#dc3545;padding:5px 10px;font-size:14px}#produtos-cadastrados button.excluir:hover{background-color:#c82333}#auth-section{max-width:400px;margin:50px auto;background:white;padding:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}#main-content{display:none}#auth-error{color:red;text-align:center;margin-top:10px}#logout-button{margin:20px auto;max-width:500px;text-align:center}#logout-button button{background-color:#6c757d}#logout-button button:hover{background-color:#5a6268}.thumbnail{width:50px;height:50px;object-fit:cover;margin:2px;cursor:pointer;border-radius:4px}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.8);z-index:1000;justify-content:center;align-items:center}.modal-content{position:relative;max-width:90%;max-height:90%;width:auto;height:auto}.modal-content .carrossel-imagens{display:flex;overflow:hidden;width:100%;height:100%}.modal-content .carrossel-imagens img{width:100%;height:auto;object-fit:contain;flex:0 0 100%;transition:transform 0.3s ease}.modal-close{position:absolute;top:10px;right:10px;background:#ff6200;color:white;border:none;padding:8px 12px;border-radius:50%;cursor:pointer;font-size:16px}.carrossel-prev,.carrossel-next{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.5);color:white;border:none;padding:10px;cursor:pointer;font-size:18px;border-radius:4px}.carrossel-prev{left:10px}.carrossel-next{right:10px}.carrossel-dots{position:absolute;bottom:10px;width:100%;text-align:center}.carrossel-dot{display:inline-block;width:10px;height:10px;background:#ccc;border-radius:50%;margin:0 5px;cursor:pointer}.carrossel-dot.ativo{background:#ff6200}</style></head><body><div id="auth-section"><h2>Autenticação</h2><form id="auth-form"><input type="password" id="auth-password" placeholder="Digite a senha" required><button type="submit">Entrar</button></form><div id="auth-error"></div></div><div id="main-content"><h1>Adicionar Produto</h1><form id="form-produto" enctype="multipart/form-data"><input type="text" name="nome" placeholder="Nome do produto" required><select name="categoria" required><option value="" disabled selected>Selecione uma categoria</option><option value="eletronicos">Eletrônicos</option><option value="moda">Moda</option><option value="fitness">Fitness</option><option value="casa">Casa e Decoração</option><option value="beleza">Beleza</option><option value="esportes">Esportes</option><option value="livros">Livros</option><option value="infantil">Infantil</option><option value="Celulares">Celulares</option><option value="Eletrodomésticos">Eletrodomésticos</option></select><select name="loja" required><option value="" disabled selected>Selecione uma loja</option><option value="amazon">Amazon</option><option value="magalu">Magalu</option><option value="shein">Shein</option><option value="shopee">Shopee</option><option value="mercadolivre">Mercado Livre</option><option value="alibaba">Alibaba</option></select><input type="url" name="link" placeholder="Link do produto (https://...)" required pattern="https?://.+"><input type="number" name="preco" placeholder="Preço do produto (ex.: 99.99)" step="0.01" min="0" required><input type="file" name="imagens" accept="image/*" multiple><button type="submit">Adicionar</button></form><div id="mensagem"></div><div id="erro"></div><div id="produtos-cadastrados"><h3>Produtos Cadastrados</h3><table id="tabela-produtos"><thead><tr><th>Nome</th><th>Categoria</th><th>Loja</th><th>Link</th><th>Preço</th><th>Imagens</th><th>Ação</th></tr></thead><tbody id="lista-produtos"></tbody></table></div><div id="github-sync"><h3>Sincronizar com GitHub</h3><input type="password" id="github-token" placeholder="GitHub Personal Access Token" required><textarea id="json-text" readonly></textarea><button onclick="atualizarGitHub()">Atualizar produtos.json no GitHub</button><textarea id="import-json" placeholder="Cole o JSON para importar"></textarea><button onclick="importarJSON()">Importar JSON</button></div><div id="logout-button"><button onclick="logout()">Sair</button></div></div><div class="modal" id="imageModal"><button class="modal-close" onclick="closeModal()">✕</button><div class="modal-content" id="modalCarrossel"><div class="carrossel-imagens" id="modalCarrosselImagens"></div><button class="carrossel-prev" onclick="moveModalCarrossel(-1)">◄</button><button class="carrossel-next" onclick="moveModalCarrossel(1)">►</button><div class="carrossel-dots" id="modalCarrosselDots"></div></div></div><script>const SENHA_CORRETA="comprasempre@098457";let produtos=JSON.parse(localStorage.getItem('produtos'))||[],currentImages=[],currentImageIndex=0;function verificarAutenticacao(){const e=sessionStorage.getItem('autenticado')==='true';if(e){document.getElementById('auth-section').style.display='none';document.getElementById('main-content').style.display='block';atualizarJSON();atualizarListaProdutos()}else{document.getElementById('auth-section').style.display='block';document.getElementById('main-content').style.display='none'}}document.getElementById('auth-form').addEventListener('submit',e=>{e.preventDefault();const t=document.getElementById('auth-password').value,a=document.getElementById('auth-error');if(t===SENHA_CORRETA){sessionStorage.setItem('autenticado','true');document.getElementById('auth-section').style.display='none';document.getElementById('main-content').style.display='block';atualizarJSON();atualizarListaProdutos();a.textContent=''}else{a.textContent='Senha incorreta!';document.getElementById('auth-password').value=''}});function logout(){sessionStorage.removeItem('autenticado');document.getElementById('auth-section').style.display='block';document.getElementById('main-content').style.display='none';document.getElementById('auth-password').value='';document.getElementById('auth-error').textContent=''}async function resizeImage(e,t,a){return new Promise((r,n)=>{if(e.size>2*1024*1024)n(new Error('Imagem muito grande. Máximo 2 MB.'));const i=new Image;i.src=URL.createObjectURL(e);i.onload=()=>{const o=document.createElement('canvas');let s=i.width,l=i.height;if(s>l){if(s>t){l=Math.round(l*t/s);s=t}}else{if(l>a){s=Math.round(s*a/l);l=a}}o.width=s;o.height=l;const c=o.getContext('2d');c.drawImage(i,0,0,s,l);o.toBlob(e=>r(e),'image/jpeg',0.8)};i.onerror=n})}document.getElementById('form-produto').addEventListener('submit',async e=>{e.preventDefault();const t=document.getElementById('mensagem'),a=document.getElementById('erro'),r=e.target.querySelector('input[name="nome"]').value,n=e.target.querySelector('select[name="categoria"]').value,i=e.target.querySelector('select[name="loja"]').value,o=e.target.querySelector('input[name="link"]').value,s=e.target.querySelector('input[name="preco"]').value,l=e.target.querySelector('input[name="imagens"]').files;if(!r||!n||!i||!o||!s){a.textContent='Todos os campos são obrigatórios!';t.textContent='';return}if(parseFloat(s)<0){a.textContent='O preço deve ser um valor positivo!';t.textContent='';return}if(l.length===0){a.textContent='Pelo menos uma imagem deve ser escolhida!';t.textContent='';return}if(l.length>3){a.textContent='Máximo de 3 imagens por produto!';t.textContent='';return}try{const c=await Promise.all(Array.from(l).map(async e=>{const t=await resizeImage(e,300,300);return new Promise((e,a)=>{const r=new FileReader;r.onload=()=>e(r.result);r.onerror=a;r.readAsDataURL(t)})}));const d={nome:r,categoria:n,loja:i,link:o,preco:s,imagens:c};produtos.push(d);localStorage.setItem('produtos',JSON.stringify(produtos));atualizarJSON();atualizarListaProdutos();t.textContent='Produto adicionado! Clique em "Atualizar produtos.json no GitHub" para sincronizar.';a.textContent='';e.target.reset()}catch(r){a.textContent=r.message||'Erro ao processar as imagens. Tente novamente.';t.textContent=''}});function atualizarJSON(){document.getElementById('json-text').value=JSON.stringify(produtos,null,2)}function atualizarListaProdutos(){const e=document.getElementById('lista-produtos');e.innerHTML='';if(produtos.length===0){e.innerHTML='<tr><td colspan="7">Nenhum produto cadastrado.</td></tr>';return}produtos.forEach((t,a)=>{const r=document.createElement('tr'),n=t.imagens&&t.imagens.length>0?t.imagens:[];r.innerHTML=`<td>${t.nome}</td><td>${t.categoria}</td><td>${t.loja}</td><td><a href="${t.link}" target="_blank">Link</a></td><td>R$ ${parseFloat(t.preco||0).toFixed(2).replace('.',',')}</td><td>${n.length>0?n.map((e,r)=>`<img src="${e}" alt="Imagem ${r+1}" class="thumbnail" onclick="openModal(${a},${r})">`).join(''):'Nenhuma imagem'}</td><td><button class="excluir" onclick="excluirProduto(${a})">Excluir</button></td>`;e.appendChild(r)})}function openModal(e,t){const a=document.getElementById('imageModal'),r=document.getElementById('modalCarrosselImagens'),n=document.getElementById('modalCarrosselDots');currentImages=produtos[e].imagens||[];currentImageIndex=t;if(currentImages.length===0)return;r.innerHTML=currentImages.map(e=>`<img src="${e}" alt="Imagem ampliada">`).join('');r.style.transform=`translateX(-${t*100}%)`;n.innerHTML=currentImages.map((e,a)=>`<span class="carrossel-dot ${a===t?'ativo':''}" onclick="setModalCarrosselImage(${a})"></span>`).join('');a.style.display='flex'}function moveModalCarrossel(e){const t=document.getElementById('modalCarrosselImagens'),a=document.getElementById('modalCarrosselDots').children,r=currentImages.length;currentImageIndex=(currentImageIndex+e+r)%r;t.style.transform=`translateX(-${currentImageIndex*100}%)`;Array.from(a).forEach((e,t)=>e.classList.toggle('ativo',t===currentImageIndex))}function setModalCarrosselImage(e){const t=document.getElementById('modalCarrosselImagens'),a=document.getElementById('modalCarrosselDots').children;currentImageIndex=e;t.style.transform=`translateX(-${e*100}%)`;Array.from(a).forEach((t,a)=>t.classList.toggle('ativo',a===e))}function closeModal(){const e=document.getElementById('imageModal');e.style.display='none';currentImages=[];currentImageIndex=0}document.getElementById('imageModal').addEventListener('click',e=>{if(e.target===e.currentTarget)closeModal()});function excluirProduto(e){produtos.splice(e,1);localStorage.setItem('produtos',JSON.stringify(produtos));atualizarJSON();atualizarListaProdutos();document.getElementById('mensagem').textContent='Produto excluído! Clique em "Atualizar produtos.json no GitHub" para sincronizar.';document.getElementById('erro').textContent=''}async function atualizarGitHub(){const e=document.getElementById('github-token').value.trim(),t=document.getElementById('json-text').value,a=document.getElementById('mensagem'),r=document.getElementById('erro');if(!e){r.textContent='Por favor, insira o GitHub Personal Access Token!';a.textContent='';return}try{const n=JSON.parse(t);if(!Array.isArray(n))throw new Error('JSON inválido! Deve ser uma lista de produtos.');let i=null;const o=await fetch('https://api.github.com/repos/bingaby/centrodecompra/contents/produtos.json',{method:'GET',headers:{'Authorization':`Bearer ${e}`,'Accept':'application/vnd.github.v3+json','Content-Type':'application/json'}});if(o.ok){const e=await o.json();i=e.sha}else if(o.status!==404){const e=await o.json();throw new Error(`Erro ao verificar produtos.json: ${e.message||o.statusText}`)}const s=btoa(unescape(encodeURIComponent(t))),l=await fetch('https://api.github.com/repos/bingaby/centrodecompra/contents/produtos.json',{method:'PUT',headers:{'Authorization':`Bearer ${e}`,'Accept':'application/vnd.github.v3+json','Content-Type':'application/json'},body:JSON.stringify({message:'Atualiza produtos.json via admin',content:s,sha:i,branch:'main'})});if(l.ok){a.textContent='produtos.json atualizado no GitHub! Os produtos devem aparecer na página principal em alguns minutos.';r.textContent=''}else{const e=await l.json();throw new Error(`Erro ao atualizar produtos.json: ${e.message||l.statusText}`)}}catch(n){console.error('Erro ao sincronizar com o GitHub:',n);r.textContent=n.message||'Erro ao sincronizar com o GitHub. Verifique o token e tente novamente.';a.textContent=''}}function importarJSON(){const e=document.getElementById('import-json').value,t=document.getElementById('mensagem'),a=document.getElementById('erro');try{const r=JSON.parse(e);if(!Array.isArray(r))throw new Error('JSON inválido! Deve ser uma lista de produtos.');produtos=r;localStorage.setItem('produtos',JSON.stringify(produtos));atualizarJSON();atualizarListaProdutos();t.textContent='Produtos importados com sucesso! Clique em "Atualizar produtos.json no GitHub" para sincronizar.';a.textContent='';document.getElementById('import-json').value=''}catch(r){a.textContent=r.message||'Erro ao importar JSON. Verifique o formato e tente novamente.';t.textContent=''}}verificarAutenticacao();</script></body></html>
